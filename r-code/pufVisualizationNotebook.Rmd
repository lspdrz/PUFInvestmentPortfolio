---
title: "PUF Investment Portfolio Visualization"
output: html_notebook
---

In this R Notebook, we will visualize the investment portfolio of the University of Texas' endowment: the Permanent University Fund. The portfolio is in PDF format, so first we need to transfer the data from a .pdf file to a .txt file.

```{r}
# Include the pdftools library to transfer data from pdf to text, and then to csv
library(pdftools)

# Download pdf with data:
download.file("https://www.utimco.org/Funds/Endowment/PUF/PUF2016DetailedInvestments.pdf", "pufInvestments2016.pdf", mode = "wb")

# Transfer pdf data into text format:
txt <- pdf_text("pufInvestments2016.pdf")
```

Next, we will read the text object into a table so we can visualize it with ggplot2 and plotly.

```{r}
library(readr)
library(stringr)
library(magrittr)
library(dplyr)

table_data <- txt [[ 3 ]] %>% 
  str_split(pattern = "\n") %>%
  unlist() %>%
  str_subset(pattern = "^[^...].*(\\.){5}") %>%
  str_c(collapse = "\n") %>%
  read_table(col_names = FALSE) %>%
  mutate(X1 = str_replace_all(X1, "(\\.)*", "")) %>%

table_data
```
Finally, we will plot the data ussing ggplot2 and plotly

```{r}
library(ggplot2)
library(plotly)
p <- ggplot(mutate(table_data), aes(x = X1, y = X2)) +
  geom_point(shape=1)

ggplotly(p)
```

